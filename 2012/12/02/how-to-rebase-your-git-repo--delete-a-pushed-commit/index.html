
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>How to rebase your git repo / delete a pushed commit</title>
    <meta name="description" content="">
    <meta name="author" content="Zifei Shan">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <!-- <link href="/assets/themes/zifei/bootstrap/css/bootstrap.min.css" rel="stylesheet"> -->
    <link href="/styles/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

<div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <!-- <a class="brand" href="/">Zifei Shan</a> -->
      <div class="brand" style="padding: 5px 20px 0px">
        <img class="thumb" title="PKU" src="/images/pkulogo40.png" href="http://www.pku.edu.cn"/>
        <a href="/" style="color: whiteSmoke">Zifei Shan</a>
      </div>
      <div class="nav-collapse">
        <ul class="nav">
                    <p><li class=""><a href="/">Home</a></li>
<li class=""><a href="/archive">Blog</a></li>
<li class=""><a href="/projects">Projects</a></li>
<li class=""><a href="/about">About</a></li></p>

        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="span10 content" >
      
<div class="page-header">
  <h1>How to rebase your git repo / delete a pushed commit </h1>
</div>

<div class="row">
  <div class="span8">
    <p>If you have a commit (or some commits / some huge files) that you really want to totally delete from your repo, to make it cleaner or smaller, you can create a new repo, and use a &#8220;git-rebase&#8221; command to do it.</p>

<p>The best place of this operation is to delete the stuff you don&#8217;t want while <strong>preserving all the historical commits</strong> of the original repository.</p>

<p>Suppose the old repo is repo_a, and you should go through this process:</p>

<ul>
<li>
<p>Create a new empty repo, say, &#8220;repo_b&#8221;.</p>
</li>

<li>
<p>Do not clone repo_b; instead, copy the repo_a to repo_b:</p>

<pre><code>  $ cp -r repo_a repo_b 
  $ cd repo_b</code></pre>
</li>

<li>
<p>Find the commit you want to delete. For example, you want to delete the commit with a huge file in somepath/hugefile. You can locate the commit by <em>git log</em>:</p>

<pre><code>  $ git log somepath/hugefile</code></pre>

<p>then you get a commit-id of the commit you want to delete.</p>
</li>

<li>
<p>Then tag your commit using this:</p>

<pre><code>  $ git tag TODELETE commit-id</code></pre>
</li>

<li>
<p>use the MAGIC rebase:</p>

<pre><code>  $ git rebase -i TODELETE~1</code></pre>

<p>This will start the rebase in interactive mode -i at the point just before the commit you want to whack. The editor will start up listing all of the commits since then. Delete the line containing the commit you want to obliterate and save the file. Rebase will do the rest of the work, deleting only that commit, and replaying all of the others back into the log. <a href='http://stackoverflow.com/questions/1338728/how-to-delete-a-git-commit'>Reference</a></p>

<p>It will show a message, on top of the message there are a set of &#8220;pick&#8221; commands. Find the one who pick the TODELETE commit, and delete that line.</p>

<p>Save the message, and the rebase is done! the TODELETE commit is gone!</p>
</li>

<li>
<p>Check if it is really gone, by either of these commands:</p>

<pre><code>    $ git log 
    $ git hist (if you have configured alias &quot;hist&quot;)</code></pre>

<p>and you find that in master branch you do not have TODELETE commit anymore.</p>

<p>If you use</p>

<pre><code>    $ git log --all
    $ git hist --all (if you have configured alias &quot;hist&quot;)</code></pre>

<p>you can see that the <em>rebase</em> creates a branch.</p>
</li>

<li>
<p>Push the change to the new repository</p>

<pre><code>  $ git remote remove origin git remote add origin

  $ git@YOUR_REMOTE_PATH/repo_b.git git push -u origin master 
    # to push changes for the first time</code></pre>
</li>

<li>
<p>This will change the &#8220;origin&#8221; of the local repo_b, to the remote repo_b, and do the initial push of the new repo.</p>
</li>

<li>
<p>Delete and clone the new repo: Now the repo_b still contains TODELETE in a branch, so you can delete it and clone it from remote. Now it is clean.</p>
</li>
</ul>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2012/11/14/chinese-life-in-israel" title="[CH]以色列留学生活点滴">&larr; Previous</a></li>
      
        <li><a href="/archive">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'zifeishan'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>02 December 2012</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags/index.html#git-ref">git <span>2</span></a></li>
     
    	<li><a href="/tags/index.html#skills-ref">skills <span>2</span></a></li>
    
  



    </ul>
    
  </div>
</div>


    </div>
    <div class="span2 fluid">
      <div class="well sidebar-nav" style="margin: 10px">
        <ul class="nav nav-list">
          <li class="nav-header">Links</li>
              
              
              


  
    
      
      	
      	<li><a href="/archive/index.html">Blog Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/blog/index.html">Blog</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/tags/index.html">Tags</a></li>
      	
      
    
  



        </ul>
      </div><!--/.well -->
    </div><!--/span-->
  </div>
</div>
  
<!-- 
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <div class="brand" style="padding: 5px 20px 0px">
        <img class="thumb" title="PKU" src="/images/pkulogo40.png" href="http://www.pku.edu.cn"/ >
        <a href="/" style="color: whiteSmoke">Zifei Shan</a>
      </div>
      <div class="nav-collapse">
        <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive/index.html">Blog Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/blog/index.html">Blog</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/tags/index.html">Tags</a></li>
      	
      
    
  



        </ul>
      </div>
    </div>
  </div>
</div>
 -->

<!-- <div class="container"> -->

<!--   <div class="content" style="padding-bottom: 50px">
    
<div class="page-header">
  <h1>How to rebase your git repo / delete a pushed commit </h1>
</div>

<div class="row">
  <div class="span8">
    <p>If you have a commit (or some commits / some huge files) that you really want to totally delete from your repo, to make it cleaner or smaller, you can create a new repo, and use a &#8220;git-rebase&#8221; command to do it.</p>

<p>The best place of this operation is to delete the stuff you don&#8217;t want while <strong>preserving all the historical commits</strong> of the original repository.</p>

<p>Suppose the old repo is repo_a, and you should go through this process:</p>

<ul>
<li>
<p>Create a new empty repo, say, &#8220;repo_b&#8221;.</p>
</li>

<li>
<p>Do not clone repo_b; instead, copy the repo_a to repo_b:</p>

<pre><code>  $ cp -r repo_a repo_b 
  $ cd repo_b</code></pre>
</li>

<li>
<p>Find the commit you want to delete. For example, you want to delete the commit with a huge file in somepath/hugefile. You can locate the commit by <em>git log</em>:</p>

<pre><code>  $ git log somepath/hugefile</code></pre>

<p>then you get a commit-id of the commit you want to delete.</p>
</li>

<li>
<p>Then tag your commit using this:</p>

<pre><code>  $ git tag TODELETE commit-id</code></pre>
</li>

<li>
<p>use the MAGIC rebase:</p>

<pre><code>  $ git rebase -i TODELETE~1</code></pre>

<p>This will start the rebase in interactive mode -i at the point just before the commit you want to whack. The editor will start up listing all of the commits since then. Delete the line containing the commit you want to obliterate and save the file. Rebase will do the rest of the work, deleting only that commit, and replaying all of the others back into the log. <a href='http://stackoverflow.com/questions/1338728/how-to-delete-a-git-commit'>Reference</a></p>

<p>It will show a message, on top of the message there are a set of &#8220;pick&#8221; commands. Find the one who pick the TODELETE commit, and delete that line.</p>

<p>Save the message, and the rebase is done! the TODELETE commit is gone!</p>
</li>

<li>
<p>Check if it is really gone, by either of these commands:</p>

<pre><code>    $ git log 
    $ git hist (if you have configured alias &quot;hist&quot;)</code></pre>

<p>and you find that in master branch you do not have TODELETE commit anymore.</p>

<p>If you use</p>

<pre><code>    $ git log --all
    $ git hist --all (if you have configured alias &quot;hist&quot;)</code></pre>

<p>you can see that the <em>rebase</em> creates a branch.</p>
</li>

<li>
<p>Push the change to the new repository</p>

<pre><code>  $ git remote remove origin git remote add origin

  $ git@YOUR_REMOTE_PATH/repo_b.git git push -u origin master 
    # to push changes for the first time</code></pre>
</li>

<li>
<p>This will change the &#8220;origin&#8221; of the local repo_b, to the remote repo_b, and do the initial push of the new repo.</p>
</li>

<li>
<p>Delete and clone the new repo: Now the repo_b still contains TODELETE in a branch, so you can delete it and clone it from remote. Now it is clean.</p>
</li>
</ul>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2012/11/14/chinese-life-in-israel" title="[CH]以色列留学生活点滴">&larr; Previous</a></li>
      
        <li><a href="/archive">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'zifeishan'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>02 December 2012</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags/index.html#git-ref">git <span>2</span></a></li>
     
    	<li><a href="/tags/index.html#skills-ref">skills <span>2</span></a></li>
    
  



    </ul>
    
  </div>
</div>


  </div>
 -->
  <footer>
    <div class="footerContainer"><div class="footer">
    &copy;Zifei Shan, 2012
    </div></div>

  </footer>

<!-- </div>  -->


<!-- <div class="container contentContainer">

<div class="content">
  
<div class="page-header">
  <h1>How to rebase your git repo / delete a pushed commit </h1>
</div>

<div class="row">
  <div class="span8">
    <p>If you have a commit (or some commits / some huge files) that you really want to totally delete from your repo, to make it cleaner or smaller, you can create a new repo, and use a &#8220;git-rebase&#8221; command to do it.</p>

<p>The best place of this operation is to delete the stuff you don&#8217;t want while <strong>preserving all the historical commits</strong> of the original repository.</p>

<p>Suppose the old repo is repo_a, and you should go through this process:</p>

<ul>
<li>
<p>Create a new empty repo, say, &#8220;repo_b&#8221;.</p>
</li>

<li>
<p>Do not clone repo_b; instead, copy the repo_a to repo_b:</p>

<pre><code>  $ cp -r repo_a repo_b 
  $ cd repo_b</code></pre>
</li>

<li>
<p>Find the commit you want to delete. For example, you want to delete the commit with a huge file in somepath/hugefile. You can locate the commit by <em>git log</em>:</p>

<pre><code>  $ git log somepath/hugefile</code></pre>

<p>then you get a commit-id of the commit you want to delete.</p>
</li>

<li>
<p>Then tag your commit using this:</p>

<pre><code>  $ git tag TODELETE commit-id</code></pre>
</li>

<li>
<p>use the MAGIC rebase:</p>

<pre><code>  $ git rebase -i TODELETE~1</code></pre>

<p>This will start the rebase in interactive mode -i at the point just before the commit you want to whack. The editor will start up listing all of the commits since then. Delete the line containing the commit you want to obliterate and save the file. Rebase will do the rest of the work, deleting only that commit, and replaying all of the others back into the log. <a href='http://stackoverflow.com/questions/1338728/how-to-delete-a-git-commit'>Reference</a></p>

<p>It will show a message, on top of the message there are a set of &#8220;pick&#8221; commands. Find the one who pick the TODELETE commit, and delete that line.</p>

<p>Save the message, and the rebase is done! the TODELETE commit is gone!</p>
</li>

<li>
<p>Check if it is really gone, by either of these commands:</p>

<pre><code>    $ git log 
    $ git hist (if you have configured alias &quot;hist&quot;)</code></pre>

<p>and you find that in master branch you do not have TODELETE commit anymore.</p>

<p>If you use</p>

<pre><code>    $ git log --all
    $ git hist --all (if you have configured alias &quot;hist&quot;)</code></pre>

<p>you can see that the <em>rebase</em> creates a branch.</p>
</li>

<li>
<p>Push the change to the new repository</p>

<pre><code>  $ git remote remove origin git remote add origin

  $ git@YOUR_REMOTE_PATH/repo_b.git git push -u origin master 
    # to push changes for the first time</code></pre>
</li>

<li>
<p>This will change the &#8220;origin&#8221; of the local repo_b, to the remote repo_b, and do the initial push of the new repo.</p>
</li>

<li>
<p>Delete and clone the new repo: Now the repo_b still contains TODELETE in a branch, so you can delete it and clone it from remote. Now it is clean.</p>
</li>
</ul>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2012/11/14/chinese-life-in-israel" title="[CH]以色列留学生活点滴">&larr; Previous</a></li>
      
        <li><a href="/archive">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'zifeishan'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>02 December 2012</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags/index.html#git-ref">git <span>2</span></a></li>
     
    	<li><a href="/tags/index.html#skills-ref">skills <span>2</span></a></li>
    
  



    </ul>
    
  </div>
</div>


</div>

</div> 

<div class="footerContainer"><div class="footer">
&copy;Zifei Shan, 2012
</div></div>
 -->    
  
  </body>
</html>

